<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù„Ø³</title>
  <style>
    :root{
      --bg:#f2f2f4; --card:#ffffff; --text:#111827; --muted:#6b7280; --border:#e5e7eb; --shadow: 0 8px 22px rgba(0,0,0,.08);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family: system-ui,-apple-system,Segoe UI,Roboto,"Noto Kufi Arabic","Noto Sans Arabic",Tahoma,Arial; background:var(--bg); color:var(--text)}
    header{position:sticky; top:0; z-index:20; background:rgba(242,242,244,.92); backdrop-filter: blur(10px); border-bottom:1px solid var(--border)}
    .wrap{max-width:1100px; margin:0 auto; padding:12px 14px}
    .topbar{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .title{font-weight:800; font-size:18px}
    .search{flex:1; min-width:220px; position:relative}
    .search input{width:100%; padding:12px 40px 12px 12px; border:1px solid var(--border); border-radius:999px; background:#fff; outline:none}
    .search .icon{position:absolute; right:12px; top:50%; transform:translateY(-50%); color:var(--muted)}
    .tabs{display:flex; gap:8px; margin-top:10px; overflow:auto; padding-bottom:6px}
    .tab{border:1px solid var(--border); background:#fff; padding:8px 12px; border-radius:999px; cursor:pointer; white-space:nowrap; font-weight:700}
    .tab.active{background:#111827; color:#fff; border-color:#111827}
    main .grid{display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:12px; padding:14px}
    @media (max-width: 700px){ main .grid{grid-template-columns: 1fr;} }
    .card{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); overflow:hidden; box-shadow:var(--shadow)}
    .imgwrap{background:#fff; cursor:zoom-in}
    .imgwrap img{width:100%; display:block; height:auto}
    .meta{padding:12px}
    .name{font-weight:900; line-height:1.3; font-size:15px; margin:0 0 6px 0}
    .row{display:flex; gap:8px; align-items:flex-start; flex-wrap:wrap; color:var(--muted); font-size:13px; line-height:1.5}
    .pill{display:inline-flex; gap:6px; align-items:center; padding:6px 10px; border:1px solid var(--border); border-radius:999px; background:#fff}
    a.btn{display:inline-flex; gap:8px; align-items:center; padding:8px 10px; border-radius:12px; border:1px solid var(--border); color:var(--text); text-decoration:none; font-weight:800; background:#fff}
    a.btn:hover{filter:brightness(.98)}
    .actions{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
    .footer{color:var(--muted); font-size:12px; padding:6px 14px 18px}
    /* modal */
    .modal{position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; padding:16px; z-index:50}
    .modal.open{display:flex}
    .modal .box{max-width:980px; width:100%; background:#fff; border-radius:18px; overflow:hidden}
    .modal .box img{width:100%; height:auto; display:block}
    .modal .close{position:absolute; top:14px; left:14px; background:#fff; border:1px solid var(--border); border-radius:999px; padding:10px 12px; cursor:pointer; font-weight:900}
  </style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="topbar">
      <div class="title">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù„Ø³ Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠØ©</div>
      <div class="search">
        <span class="icon">ğŸ”</span>
        <input id="q" type="search" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù„Ø³..." autocomplete="off" />
      </div>
    </div>
    <div class="tabs" id="tabs"></div>
  </div>
</header>

<main>
  <div class="wrap">
    <div class="grid" id="grid"></div>
    <div class="footer" id="count"></div>
  </div>
</main>

<div class="modal" id="modal" aria-hidden="true">
  <button class="close" id="closeBtn">Ø¥ØºÙ„Ø§Ù‚ âœ•</button>
  <div class="box"><img id="modalImg" alt="Majles"/></div>
</div>

<script src="items.js"></script>
<script>
let ALL = [];
let currentBlock = "all";

function normalize(s){
  return (s||"").toString()
    .replace(/[\u064B-\u0652]/g,'') // ØªØ´ÙƒÙŠÙ„
    .replace(/\s+/g,' ')
    .trim();
}

function renderTabs(blocks){
  const tabs = document.getElementById('tabs');
  tabs.innerHTML = '';
  const allBtn = document.createElement('button');
  allBtn.className = 'tab active';
  allBtn.textContent = 'Ø§Ù„ÙƒÙ„';
  allBtn.onclick = ()=>{ currentBlock='all'; setActive(allBtn); render(); };
  tabs.appendChild(allBtn);

  blocks.forEach(b=>{
    const btn = document.createElement('button');
    btn.className = 'tab';
    btn.textContent = 'Ù…Ø¬Ù…Ø¹ ' + b;
    btn.onclick = ()=>{ currentBlock=b; setActive(btn); render(); };
    tabs.appendChild(btn);
  });
}

function setActive(btn){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  btn.classList.add('active');
}

function card(item){
  const div = document.createElement('div');
  div.className = 'card';

  const imgwrap = document.createElement('div');
  imgwrap.className = 'imgwrap';
  const img = document.createElement('img');
  img.loading = 'lazy';
  img.src = item.image;
  img.alt = item.name;
  imgwrap.appendChild(img);
  imgwrap.onclick = ()=> openModal(item.image);
  div.appendChild(imgwrap);

  const meta = document.createElement('div');
  meta.className = 'meta';
  const h = document.createElement('p');
  h.className = 'name';
  h.textContent = item.name;
  meta.appendChild(h);

  const row = document.createElement('div');
  row.className = 'row';
  row.innerHTML = `
    <span class="pill">ğŸ˜ï¸ Ù…Ù†Ø²Ù„: ${item.home || '-'}</span>
    <span class="pill">ğŸ›£ï¸ Rd No: ${item.road || '-'}</span>
    <span class="pill">ğŸ“ Ù…Ø¬Ù…Ø¹: ${item.block}</span>
  `;
  meta.appendChild(row);

  const actions = document.createElement('div');
  actions.className = 'actions';

  if(item.mapsUrl){
    const a = document.createElement('a');
    a.className = 'btn';
    a.href = item.mapsUrl;
    a.target = '_blank';
    a.rel = 'noopener';
    a.textContent = 'ÙØªØ­ Ø§Ù„Ù„ÙˆÙƒÙŠØ´Ù† ÙÙŠ Ø®Ø±Ø§Ø¦Ø· Google';
    actions.appendChild(a);
  }

  if(item.contact1){
    const a1 = document.createElement('a');
    a1.className = 'btn';
    const phone = (item.contact1.match(/\d+/g)||[]).join('');
    a1.href = phone ? ('tel:' + phone) : '#';
    a1.textContent = 'Ø§ØªØµØ§Ù„ 1';
    actions.appendChild(a1);
  }
  if(item.contact2){
    const a2 = document.createElement('a');
    a2.className = 'btn';
    const phone = (item.contact2.match(/\d+/g)||[]).join('');
    a2.href = phone ? ('tel:' + phone) : '#';
    a2.textContent = 'Ø§ØªØµØ§Ù„ 2';
    actions.appendChild(a2);
  }

  meta.appendChild(actions);
  div.appendChild(meta);
  return div;
}

function render(){
  const q = normalize(document.getElementById('q').value);
  const grid = document.getElementById('grid');
  grid.innerHTML = '';

  let list = ALL.slice();
  if(currentBlock !== 'all'){
    list = list.filter(x => x.block === currentBlock);
  }
  if(q){
    list = list.filter(x => normalize(x.name).includes(q) || normalize(x.note||'').includes(q));
  }

  list.forEach(item => grid.appendChild(card(item)));
  document.getElementById('count').textContent = `Ø¹Ø¯Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ${list.length}`;
}

function openModal(src){
  const modal = document.getElementById('modal');
  document.getElementById('modalImg').src = src;
  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');
}
function closeModal(){
  const modal = document.getElementById('modal');
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
}
document.getElementById('closeBtn').onclick = closeModal;
document.getElementById('modal').addEventListener('click', (e)=>{
  if(e.target.id === 'modal') closeModal();
});
document.getElementById('q').addEventListener('input', render);

(function(){
  ALL = window.MAJLES_DATA || [];
  const blocks = Array.from(new Set(ALL.map(x=>x.block))).sort((a,b)=>Number(a)-Number(b));
  renderTabs(blocks);
  render();
})();</script>
</body>
</html>
